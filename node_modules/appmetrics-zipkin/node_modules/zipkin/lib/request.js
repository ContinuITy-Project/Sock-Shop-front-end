'use strict';

function appendZipkinHeaders(req, traceId) {
  var headers = req.headers || {};
  headers['X-B3-Traceid'] = traceId.traceId;
  headers['X-B3-Spanid'] = traceId.spanId;

  traceId._parentId.ifPresent(function (psid) {
    headers['X-B3-Parentid'] = psid;
  });
  traceId.sampled.ifPresent(function (sampled) {
    headers['X-B3-Sampled'] = sampled ? '1' : '0';
  });

  return headers;
}

function addZipkinHeaders(req, traceId) {
  var headers = appendZipkinHeaders(req, traceId);
  return Object.assign({}, req, { headers: headers });
}

module.exports = {
  addZipkinHeaders: addZipkinHeaders
};
